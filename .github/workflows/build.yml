name: Build and Release

on:
  # ÂΩìÊé®ÈÄÅ v ÂºÄÂ§¥ÁöÑ tag Êó∂Ëá™Âä®Ëß¶ÂèëÂπ∂ÂèëÂ∏ÉÂà∞ ReleaseÔºàÊîØÊåÅ v1.0.0„ÄÅv1.0.0alpha1„ÄÅv1.0.0-beta1 Á≠âÔºâ
  push:
    tags:
      - 'v*'
  
  # ÊâãÂä®Ëß¶ÂèëÁºñËØëÔºà‰∏ç‰∏ä‰º†Âà∞ ReleaseÔºâ
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          lfs: true
      
      - name: Extract version from tag
        id: version
        if: startsWith(github.ref, 'refs/tags/v')
        run: |
          $tag = "${{ github.ref }}"
          $version = $tag -replace 'refs/tags/v', ''
          Write-Host "version=$version" >> $env:GITHUB_OUTPUT
          Write-Host "Extracted version: $version"
          
          # Ê£ÄÊµãÊòØÂê¶‰∏∫È¢ÑÂèëÂ∏ÉÁâàÊú¨Ôºàalpha, beta, rc Á≠âÔºâ
          $isPrerelease = "false"
          if ($version -match '(?i)(alpha|beta|rc|pre)') {
            $isPrerelease = "true"
            Write-Host "This is a prerelease version"
          }
          Write-Host "is_prerelease=$isPrerelease" >> $env:GITHUB_OUTPUT
      
      - name: Checkout Git LFS files
        run: |
          Write-Host "Checking Git LFS installation..."
          git lfs version
          Write-Host "Pulling LFS files..."
          git lfs pull
      
      - name: Setup AutoHotkey v2 compiler from repository
        run: |
          # ‰ΩøÁî®‰ª£Á†ÅÂ∫ì‰∏≠ÁöÑ AutoHotkeyÔºàÂ∑≤ÈÄöËøá Git LFS ‰∏ãËΩΩÔºâ
          $ahkRepoPath = "${{ github.workspace }}\AutoHotkey_2.0.19"
          
          if (-not (Test-Path $ahkRepoPath)) {
            Write-Error "AutoHotkey_2.0.19 directory not found in repository!"
            exit 1
          }
          
          Write-Host "Using AutoHotkey from repository: $ahkRepoPath"
          
          # È™åËØÅ Git LFS Êñá‰ª∂ÊòØÂê¶Ê≠£Á°Æ‰∏ãËΩΩ
          Write-Host "Verifying LFS files..."
          Get-ChildItem -Path $ahkRepoPath -Recurse -Filter "*.exe" | ForEach-Object {
            $file = $_
            $size = (Get-Item $file.FullName).Length
            Write-Host "  $($file.Name): $size bytes"
            
            # Ê£ÄÊü•Êñá‰ª∂Â§ßÂ∞èÔºàLFS ÊåáÈíàÊñá‰ª∂ÈÄöÂ∏∏ÂæàÂ∞èÔºåÁ∫¶ 130 Â≠óËäÇÔºâ
            if ($size -lt 1024) {
              Write-Warning "  WARNING: $($file.Name) is very small ($size bytes), might be LFS pointer file!"
              Write-Host "  Attempting to pull LFS file..."
              git lfs pull --include="$($file.FullName)"
              
              # ÂÜçÊ¨°Ê£ÄÊü•Â§ßÂ∞è
              $newSize = (Get-Item $file.FullName).Length
              Write-Host "  After pull: $newSize bytes"
            }
          }
          
          # Êü•ÊâæÁºñËØëÂô®ÔºàAhk2Exe.exe Êàñ Aut2Exe.exeÔºåÂèØËÉΩÂú® Compiler Â≠êÁõÆÂΩï‰∏≠Ôºâ
          $compilerPath = "$ahkRepoPath\Compiler"
          $ahk2ExePath = "$compilerPath\Ahk2Exe.exe"
          $aut2ExePath = "$compilerPath\Aut2Exe.exe"
          
          # Ê£ÄÊü•ÁºñËØëÂô®ÊòØÂê¶Â∑≤Â≠òÂú®‰∫é‰ªìÂ∫ì‰∏≠Ôºà‰ºòÂÖàÊü•Êâæ Ahk2Exe.exeÔºåÁÑ∂ÂêéÊòØ Aut2Exe.exeÔºâ
          $foundCompiler = $null
          if (Test-Path $ahk2ExePath) {
            $foundCompiler = $ahk2ExePath
            Write-Host "Compiler found at: $compilerPath (Ahk2Exe.exe)"
            
            # È™åËØÅÊñá‰ª∂Â§ßÂ∞èÂíåÂÆåÊï¥ÊÄß
            $fileSize = (Get-Item $foundCompiler).Length
            Write-Host "Compiler file size: $fileSize bytes"
            
            # Â¶ÇÊûúÊñá‰ª∂Â§™Â∞èÔºåÂèØËÉΩÊòØ LFS ÊåáÈíàÊñá‰ª∂ÔºåÈúÄË¶ÅÈáçÊñ∞ÊãâÂèñ
            if ($fileSize -lt 1024) {
              Write-Warning "Compiler file is too small, pulling from LFS..."
              git lfs pull --include="$foundCompiler" --exclude=""
              $fileSize = (Get-Item $foundCompiler).Length
              Write-Host "After LFS pull, file size: $fileSize bytes"
            }
            
            # È™åËØÅÊñá‰ª∂Â§¥ÔºàÊ£ÄÊü•ÊòØÂê¶‰∏∫ PE ÂèØÊâßË°åÊñá‰ª∂ - MZ headerÔºâ
            try {
              $fileStream = [System.IO.File]::OpenRead($foundCompiler)
              $bytes = New-Object byte[] 2
              $fileStream.Read($bytes, 0, 2) | Out-Null
              $fileStream.Close()
              
              $isPE = ($bytes[0] -eq 0x4D -and $bytes[1] -eq 0x5A)  # 'MZ' = 0x4D 0x5A
              if (-not $isPE) {
                Write-Error "Compiler file does not appear to be a valid Windows executable!"
                Write-Host "File header: 0x$($bytes[0].ToString('X2')) 0x$($bytes[1].ToString('X2'))"
                Write-Host "Expected: 0x4D 0x5A (MZ header)"
                exit 1
              }
              Write-Host "Compiler file validation: OK (valid PE executable with MZ header)"
            } catch {
              Write-Warning "Could not validate compiler file header: $_"
            }
            
          } elseif (Test-Path $aut2ExePath) {
            $foundCompiler = $aut2ExePath
            Write-Host "Compiler found at: $compilerPath (Aut2Exe.exe)"
            
            # È™åËØÅÊñá‰ª∂
            $fileSize = (Get-Item $foundCompiler).Length
            if ($fileSize -lt 1024) {
              git lfs pull --include="$foundCompiler"
            }
          }
          
          if ($foundCompiler) {
            Write-Host "COMPILER_PATH=$compilerPath" >> $env:GITHUB_ENV
            Write-Host "COMPILER_EXE=$foundCompiler" >> $env:GITHUB_ENV
            Write-Host "Compiler setup complete: COMPILER_PATH=$compilerPath"
          } else {
            # Â¶ÇÊûúÊâæ‰∏çÂà∞Ôºå‰ªé GitHub ‰∏ãËΩΩÁºñËØëÂô®
            Write-Host "Compiler not found in repository, downloading from GitHub..."
            
            # ÂàõÂª∫ Compiler ÁõÆÂΩï
            if (-not (Test-Path $compilerPath)) {
              New-Item -ItemType Directory -Path $compilerPath -Force | Out-Null
            }
            
            # Â∞ùËØï‰ªé Ahk2Exe ‰ªìÂ∫ìËé∑ÂèñÊúÄÊñ∞ release ÁöÑ asset
            try {
              Write-Host "Fetching latest Ahk2Exe release from GitHub API..."
              $latestRelease = Invoke-RestMethod -Uri "https://api.github.com/repos/AutoHotkey/Ahk2Exe/releases/latest" -ErrorAction Stop
              
              # Êü•Êâæ ZIP ÊàñÂéãÁº©ÂåÖ asset
              $compilerAsset = $latestRelease.assets | Where-Object { 
                $_.name -like "*.zip" -or $_.name -like "*Ahk2Exe*" 
              } | Select-Object -First 1
              
              if ($compilerAsset) {
                $compilerUrl = $compilerAsset.browser_download_url
                Write-Host "Found compiler asset: $($compilerAsset.name)"
              } else {
                throw "No ZIP asset found in latest release"
              }
            } catch {
              # Â¶ÇÊûú API Â§±Ë¥•ÔºåÂ∞ùËØï‰ΩøÁî®Âõ∫ÂÆöÁöÑ‰∏ãËΩΩÈìæÊé•Ôºà‰ªé v2.0.19 ÂØπÂ∫îÁöÑÁâàÊú¨Ôºâ
              Write-Host "Failed to fetch from API, using fallback URL..."
              $compilerUrl = "https://github.com/AutoHotkey/Ahk2Exe/releases/download/v2.0.19/Ahk2Exe.zip"
            }
            
            $compilerZip = "$env:TEMP\Ahk2Exe.zip"
            
            Write-Host "Downloading compiler from: $compilerUrl"
            try {
              Invoke-WebRequest -Uri $compilerUrl -OutFile $compilerZip -ErrorAction Stop
            } catch {
              Write-Error "Failed to download compiler: $_"
              Write-Host "Trying alternative: downloading from AutoHotkey release..."
              
              # Â§áÁî®ÊñπÊ°àÔºö‰ªé AutoHotkey ‰∏ª‰ªìÂ∫ì‰∏ãËΩΩÂÆåÊï¥ÁâàÊú¨ÔºàÂèØËÉΩÂåÖÂê´ÁºñËØëÂô®Ôºâ
              $ahkRelease = Invoke-RestMethod -Uri "https://api.github.com/repos/AutoHotkey/AutoHotkey/releases/tags/v2.0.19"
              $ahkZipAsset = $ahkRelease.assets | Where-Object { $_.name -like "AutoHotkey_2.0.19.zip" } | Select-Object -First 1
              
              if ($ahkZipAsset) {
                $fallbackZip = "$env:TEMP\AutoHotkey_Full.zip"
                Write-Host "Downloading full AutoHotkey package: $($ahkZipAsset.browser_download_url)"
                Invoke-WebRequest -Uri $ahkZipAsset.browser_download_url -OutFile $fallbackZip
                
                # Ëß£ÂéãÂπ∂Êü•ÊâæÁºñËØëÂô®
                $tempExtract = "$env:TEMP\AutoHotkey_Extract"
                Expand-Archive -Path $fallbackZip -DestinationPath $tempExtract -Force
                
                # Êü•Êâæ Aut2Exe.exeÔºàÂ∞ùËØïÂ§öÁßçÂèØËÉΩÁöÑÊñá‰ª∂ÂêçÔºâ
                $foundCompiler = $null
                $possibleNames = @("Aut2Exe.exe", "Ahk2Exe.exe", "Aut2Exe64.exe", "Ahk2Exe64.exe")
                
                foreach ($name in $possibleNames) {
                  $foundCompiler = Get-ChildItem -Path $tempExtract -Recurse -Filter $name -ErrorAction SilentlyContinue | Select-Object -First 1
                  if ($foundCompiler) {
                    Write-Host "Found compiler in AutoHotkey package: $($foundCompiler.FullName)"
                    break
                  }
                }
                
                if ($foundCompiler) {
                  Copy-Item -Path $foundCompiler.FullName -Destination $aut2ExePath -Force
                  Write-Host "Compiler extracted successfully"
                  Write-Host "COMPILER_PATH=$compilerPath" >> $env:GITHUB_ENV
                  exit 0
                } else {
                  Write-Host "Listing all .exe files in AutoHotkey package:"
                  Get-ChildItem -Path $tempExtract -Recurse -Filter "*.exe" | Select-Object FullName | ForEach-Object { Write-Host "  $($_.FullName)" }
                  throw "Aut2Exe.exe not found in AutoHotkey package"
                }
              } else {
                throw "Cannot find compiler download URL"
              }
            }
            
            Write-Host "Extracting compiler..."
            Expand-Archive -Path $compilerZip -DestinationPath $compilerPath -Force
            
            # ÂàóÂá∫Ëß£ÂéãÂêéÁöÑÊâÄÊúâÊñá‰ª∂ÔºàË∞ÉËØï‰ø°ÊÅØÔºâ
            Write-Host "Listing all extracted files:"
            Get-ChildItem -Path $compilerPath -Recurse | Select-Object FullName, Name | ForEach-Object { 
              Write-Host "  $($_.FullName)"
            }
            
            # Êü•Êâæ Aut2Exe.exeÔºàÂ∞ùËØïÂ§öÁßçÂèØËÉΩÁöÑÊñá‰ª∂ÂêçÔºâ
            $foundCompiler = $null
            $possibleNames = @("Aut2Exe.exe", "Ahk2Exe.exe", "Aut2Exe64.exe", "Ahk2Exe64.exe")
            
            foreach ($name in $possibleNames) {
              $foundCompiler = Get-ChildItem -Path $compilerPath -Recurse -Filter $name -ErrorAction SilentlyContinue | Select-Object -First 1
              if ($foundCompiler) {
                Write-Host "Found compiler: $($foundCompiler.FullName)"
                break
              }
            }
            
            if ($foundCompiler) {
              $compilerPath = $foundCompiler.DirectoryName
              $aut2ExePath = $foundCompiler.FullName
              Write-Host "Compiler found at: $compilerPath"
              Write-Host "COMPILER_PATH=$compilerPath" >> $env:GITHUB_ENV
            } else {
              Write-Error "Failed to find Aut2Exe.exe after download!"
              Write-Host "Searched for: $($possibleNames -join ', ')"
              Write-Host "Listing all .exe files in compiler directory:"
              Get-ChildItem -Path $compilerPath -Recurse -Filter "*.exe" | Select-Object FullName | ForEach-Object { Write-Host "  $($_.FullName)" }
              exit 1
            }
          }
      
      - name: Compile script to exe (64-bit)
        run: |
          $scriptPath = "${{ github.workspace }}\autoloot.ahk"
          $outputName = "autoloot"
          
          # Â¶ÇÊûúÊòØ tag ÂèëÂ∏ÉÔºå‰ΩøÁî®ÁâàÊú¨Âè∑ÂëΩÂêç
          if ("${{ steps.version.outputs.version }}" -ne "") {
            $outputName = "autoloot-v${{ steps.version.outputs.version }}"
            Write-Host "Building release version: $outputName.exe"
          } else {
            Write-Host "Building development version: $outputName.exe"
          }
          
          $outputPath = "${{ github.workspace }}\$outputName.exe"
          
          # Ê£ÄÊü•ÁéØÂ¢ÉÂèòÈáèÊòØÂê¶ËÆæÁΩÆ
          Write-Host "COMPILER_PATH environment variable: $env:COMPILER_PATH"
          Write-Host "COMPILER_EXE environment variable: $env:COMPILER_EXE"
          
          # Â¶ÇÊûú COMPILER_EXE Â∑≤ÁªèËÆæÁΩÆÔºåÁõ¥Êé•‰ΩøÁî®
          if ($env:COMPILER_EXE -and (Test-Path $env:COMPILER_EXE)) {
            $compilerExe = $env:COMPILER_EXE
            Write-Host "Using compiler from COMPILER_EXE: $compilerExe"
          } elseif ($env:COMPILER_PATH) {
            # Âê¶ÂàôÂ∞ùËØï‰ªé COMPILER_PATH Êü•Êâæ
            $compilerExe = "$env:COMPILER_PATH\Ahk2Exe.exe"
            if (-not (Test-Path $compilerExe)) {
              $compilerExe = "$env:COMPILER_PATH\Aut2Exe.exe"
            }
          } else {
            # Â¶ÇÊûúÈÉΩÊ≤°ÊúâËÆæÁΩÆÔºåÂ∞ùËØï‰ªé‰ªìÂ∫ì‰∏≠Êü•Êâæ
            $ahkRepoPath = "${{ github.workspace }}\AutoHotkey_2.0.19"
            $compilerPath = "$ahkRepoPath\Compiler"
            $compilerExe = "$compilerPath\Ahk2Exe.exe"
            if (-not (Test-Path $compilerExe)) {
              $compilerExe = "$compilerPath\Aut2Exe.exe"
            }
            Write-Host "Trying to find compiler in repository: $compilerExe"
          }
          
          if (-not (Test-Path $compilerExe)) {
            Write-Error "Compiler executable not found!"
            Write-Host "Searched paths:"
            Write-Host "  COMPILER_EXE: $env:COMPILER_EXE"
            Write-Host "  COMPILER_PATH\Ahk2Exe.exe: $env:COMPILER_PATH\Ahk2Exe.exe"
            Write-Host "  COMPILER_PATH\Aut2Exe.exe: $env:COMPILER_PATH\Aut2Exe.exe"
            Write-Host "Checking repository for compiler..."
            $ahkRepoPath = "${{ github.workspace }}\AutoHotkey_2.0.19"
            Get-ChildItem -Path "$ahkRepoPath\Compiler" -Recurse -Filter "*.exe" -ErrorAction SilentlyContinue | ForEach-Object {
              Write-Host "  Found: $($_.FullName)"
            }
            exit 1
          }
          
          Write-Host "Using compiler: $compilerExe"
          
          # Êü•Êâæ AutoHotkey 64‰Ωç bin Êñá‰ª∂ÔºàÁî®‰∫éÁºñËØëÔºâ
          $ahkBinPath = "${{ github.workspace }}\AutoHotkey_2.0.19"
          $binFile = Get-ChildItem -Path $ahkBinPath -Recurse -Filter "AutoHotkey*.bin" | Where-Object { $_.Name -like "*64*" -or $_.Name -like "*U64*" } | Select-Object -First 1
          
          if (-not $binFile) {
            Write-Warning "64-bit bin file not found, trying default..."
            $binFile = Get-ChildItem -Path $ahkBinPath -Recurse -Filter "*.bin" | Select-Object -First 1
          }
          
          # ÂáÜÂ§áÁºñËØëÂèÇÊï∞
          $compileArgs = @()
          $compileArgs += "/in"
          $compileArgs += "`"$scriptPath`""
          $compileArgs += "/out"
          $compileArgs += "`"$outputPath`""
          
          if ($binFile) {
            Write-Host "Using bin file: $($binFile.FullName)"
            $compileArgs += "/bin"
            $compileArgs += "`"$($binFile.FullName)`""
          } else {
            # Â¶ÇÊûú‰∏çÊåáÂÆö binÔºå‰ΩøÁî® AutoHotkey 64‰Ωç exe ‰Ωú‰∏∫ base
            $ahk64Exe = "$ahkBinPath\AutoHotkey64.exe"
            if (Test-Path $ahk64Exe) {
              Write-Host "Using AutoHotkey64.exe as base: $ahk64Exe"
              $compileArgs += "/bin"
              $compileArgs += "`"$ahk64Exe`""
            } else {
              Write-Warning "No base file found, compiler will use default"
            }
          }
          
          # ‰ΩøÁî®ÁºñËØëÂô®ÁºñËØëÔºà64‰ΩçÔºâ
          Write-Host "Compiling script to exe..."
          Write-Host "Command: $compilerExe $($compileArgs -join ' ')"
          
          # ÊâßË°åÁºñËØëÂëΩ‰ª§Âπ∂ÊçïËé∑ËæìÂá∫
          try {
            $process = Start-Process -FilePath $compilerExe -ArgumentList $compileArgs -Wait -PassThru -NoNewWindow -RedirectStandardOutput "$env:TEMP\compiler_output.txt" -RedirectStandardError "$env:TEMP\compiler_error.txt"
            
            # ËØªÂèñËæìÂá∫
            if (Test-Path "$env:TEMP\compiler_output.txt") {
              $output = Get-Content "$env:TEMP\compiler_output.txt" -Raw
              if ($output) {
                Write-Host "Compiler output:"
                Write-Host $output
              }
            }
            
            if (Test-Path "$env:TEMP\compiler_error.txt") {
              $compilerError = Get-Content "$env:TEMP\compiler_error.txt" -Raw
              if ($compilerError) {
                Write-Host "Compiler errors:"
                Write-Host $compilerError
              }
            }
            
            Write-Host "Compiler exit code: $($process.ExitCode)"
            
            if ($process.ExitCode -ne 0) {
              Write-Error "Compiler exited with code: $($process.ExitCode)"
            }
          } catch {
            Write-Error "Failed to execute compiler: $_"
            exit 1
          }
          
          # Á≠âÂæÖ‰∏Ä‰∏ãÁ°Æ‰øùÊñá‰ª∂ÂÜôÂÖ•ÂÆåÊàê
          Start-Sleep -Seconds 2
          
          # È™åËØÅËæìÂá∫Êñá‰ª∂ÊòØÂê¶Â≠òÂú®
          if (Test-Path $outputPath) {
            $fileSize = (Get-Item $outputPath).Length
            Write-Host "Build successful! File size: $([math]::Round($fileSize / 1KB, 2)) KB"
            Write-Host "OUTPUT_EXE=$outputName.exe" >> $env:GITHUB_ENV
          } else {
            Write-Error "Build failed! Output file not found at: $outputPath"
            Write-Host "Checking for output files in workspace..."
            Get-ChildItem -Path "${{ github.workspace }}" -Filter "*.exe" -ErrorAction SilentlyContinue | ForEach-Object {
              Write-Host "Found: $($_.FullName) ($([math]::Round($_.Length / 1KB, 2)) KB)"
            }
            Write-Host "Checking script directory..."
            Get-ChildItem -Path (Split-Path $scriptPath) -Filter "*.exe" -ErrorAction SilentlyContinue | ForEach-Object {
              Write-Host "Found: $($_.FullName) ($([math]::Round($_.Length / 1KB, 2)) KB)"
            }
            exit 1
          }
      
      - name: Generate checksum
        run: |
          # ‰ªéÁéØÂ¢ÉÂèòÈáèÊàñÈªòËÆ§ÂÄºËé∑ÂèñËæìÂá∫Êñá‰ª∂Âêç
          $outputFileName = $env:OUTPUT_EXE
          if (-not $outputFileName) {
            # Â¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆÔºåÊ†πÊçÆÊòØÂê¶ÊòØ tag ÊûÑÂª∫Êù•Á°ÆÂÆö
            if ("${{ steps.version.outputs.version }}" -ne "") {
              $outputFileName = "autoloot-v${{ steps.version.outputs.version }}.exe"
            } else {
              $outputFileName = "autoloot.exe"
            }
            Write-Host "OUTPUT_EXE not set, using default: $outputFileName"
          }
          
          $exePath = "${{ github.workspace }}\$outputFileName"
          
          # È™åËØÅÊñá‰ª∂ÊòØÂê¶Â≠òÂú®
          if (-not (Test-Path $exePath)) {
            Write-Error "Executable file not found: $exePath"
            Write-Host "Searching for exe files in workspace..."
            Get-ChildItem -Path "${{ github.workspace }}" -Filter "*.exe" | ForEach-Object {
              Write-Host "Found: $($_.FullName)"
            }
            exit 1
          }
          
          $checksumPath = "${{ github.workspace }}\$outputFileName.sha256"
          
          Write-Host "Generating SHA256 checksum for: $exePath"
          $hash = Get-FileHash -Path $exePath -Algorithm SHA256
          $checksum = "$($hash.Hash)  $outputFileName"
          Set-Content -Path $checksumPath -Value $checksum
          
          Write-Host "Checksum generated: $checksum"
          Write-Host "OUTPUT_EXE=$outputFileName" >> $env:GITHUB_ENV
      
      - name: Create GitHub Release (tag only)
        if: startsWith(github.ref, 'refs/tags/v')
        uses: softprops/action-gh-release@v1
        with:
          tag_name: ${{ github.ref_name }}
          name: Release ${{ steps.version.outputs.version }}
          prerelease: ${{ steps.version.outputs.is_prerelease == 'true' }}
          body: |
            ## AutoLoot ${{ steps.version.outputs.version }}
            
            ${{ steps.version.outputs.is_prerelease == 'true' && '‚ö†Ô∏è **This is a prerelease version**' || '' }}
            
            ### Downloads
            - **[autoloot-${{ steps.version.outputs.version }}.exe](https://github.com/${{ github.repository }}/releases/download/${{ github.ref_name }}/autoloot-${{ steps.version.outputs.version }}.exe)**
            - [SHA256 Checksum](https://github.com/${{ github.repository }}/releases/download/${{ github.ref_name }}/autoloot-${{ steps.version.outputs.version }}.exe.sha256)
            
            ### Installation
            1. Download the `autoloot-${{ steps.version.outputs.version }}.exe` file
            2. Run it directly (no installation required)
            3. Configure keys using `Ctrl+Alt+Shift+Key`
            
            ### Features
            - üéÆ Multi-key support
            - ‚ö° Anti-detection algorithms
            - üéõÔ∏è Real-time speed adjustment
            - üñ•Ô∏è On-screen display
            - üíæ Configuration persistence
          files: |
            ${{ env.OUTPUT_EXE }}
            ${{ env.OUTPUT_EXE }}.sha256
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Upload artifact (manual build)
        if: github.event_name == 'workflow_dispatch'
        uses: actions/upload-artifact@v4
        with:
          name: autoloot-build
          path: |
            ${{ env.OUTPUT_EXE }}
            ${{ env.OUTPUT_EXE }}.sha256
          retention-days: 30
